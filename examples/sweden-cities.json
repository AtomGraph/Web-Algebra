{
  "ForEach": {
    "table": {
      "SELECT": {
        "endpoint": "https://dbpedia.org/sparql",
        "query": "PREFIX dbo: <http://dbpedia.org/ontology/>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nSELECT ?city ?cityName WHERE {\n  ?city a dbo:City ;\n        dbo:country <http://dbpedia.org/resource/Sweden> ;\n        dbo:populationTotal ?pop ;\n        rdfs:label ?cityName .\n  FILTER(lang(?cityName) = 'en')\n} ORDER BY DESC(?pop) LIMIT 5"
      }
    },
    "operation": [
      {
        "GET": {
          "url": {
            "ValueOf": {
              "var": "city"
            }
          }
        }
      },
      {
        "DESCRIBE": {
          "endpoint": "https://dbpedia.org/sparql",
          "query": {
            "Substitute": {
              "query": "DESCRIBE ?city",
              "var": "city",
              "binding": {
                "ValueOf": {
                  "var": "city"
                }
              }
            }
          }
        }
      },
      {
        "CONSTRUCT": {
          "endpoint": "https://dbpedia.org/sparql",
          "query": {
            "Substitute": {
              "query": "PREFIX dbo: <http://dbpedia.org/ontology/>\nCONSTRUCT { ?city dbo:populationTotal ?pop } WHERE { ?city dbo:populationTotal ?pop }",
              "var": "city",
              "binding": {
                "ValueOf": {
                  "var": "city"
                }
              }
            }
          }
        }
      },
      {
        "POST": {
          "url": {
            "ResolveURI": {
              "base": "https://localhost:4443/swe/",
              "relative": {
                "EncodeForURI": {
                  "input": {
                    "ValueOf": {
                      "var": "cityName"
                    }
                  }
                }
              }
            }
          },
          "data": {
            "Merge": {
              "first": {
                "GET": {
                  "url": {
                    "ValueOf": {
                      "var": "city"
                    }
                  }
                }
              },
              "second": {
                "CONSTRUCT": {
                  "endpoint": "https://dbpedia.org/sparql",
                  "query": {
                    "Substitute": {
                      "query": "PREFIX dbo: <http://dbpedia.org/ontology/>\nCONSTRUCT { ?city dbo:populationTotal ?pop } WHERE { ?city dbo:populationTotal ?pop }",
                      "var": "city",
                      "binding": {
                        "ValueOf": {
                          "var": "city"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "PUT": {
          "url": {
            "ResolveURI": {
              "base": "https://localhost:4443/docs/",
              "relative": {
                "STRUUID": {}
              }
            }
          },
          "data": {
            "@context": {
              "schema": "http://schema.org/",
              "dbr": "http://dbpedia.org/resource/"
            },
            "@type": "schema:Document",
            "schema:about": {
              "ValueOf": {
                "var": "city"
              }
            }
          }
        }
      }
    ]
  }
}
